<page-header [title]="'高级表单'">
    高级表单常见于一次性输入和提交大批量数据的场景。（示例采用响应式表单，也可使用模板驱动方式）
</page-header>
<form (ngSubmit)="_submitForm()" [formGroup]="form" [nzLayout]="'vertical'" nz-form>
    <nz-card [nzBordered]="false" nzTitle="仓库管理">
        <nz-row nzGutter="16">
            <nz-col nzLg="6" nzMd="12" nzSm="24">
                <nz-form-item>
                    <nz-form-label nzFor="name">仓库名</nz-form-label>
                    <nz-form-control nzErrorTip="请输入仓库名称">
                        <input formControlName="name" id="name" nz-input placeholder="请输入仓库名称"/>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzLg]="{ span: 8 }" [nzMd]="{ span: 12 }" [nzXl]="{ span: 6, offset: 2 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>仓库域名</nz-form-label>
                    <nz-form-control nzErrorTip="请输入仓库域名">
                        <nz-input-group nzAddOnAfter=".com" nzAddOnBefore="http://">
                            <input formControlName="url" nz-input placeholder="请输入"/>
                        </nz-input-group>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzLg]="{ span: 10 }" [nzMd]="{ span: 24 }" [nzXl]="{ span: 8, offset: 2 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>仓库管理员</nz-form-label>
                    <nz-form-control nzErrorTip="请选择管理员">
                        <nz-select [nzPlaceHolder]="'请选择管理员'" [nzShowSearch]="true" formControlName="owner">
                            <nz-option *ngFor="let i of users" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
        </nz-row>
        <nz-row nzGutter="16">
            <nz-col nzLg="6" nzMd="12" nzSm="24">
                <nz-form-item>
                    <nz-form-label>审批员</nz-form-label>
                    <nz-form-control nzErrorTip="请选择审批员">
                        <nz-select [nzPlaceHolder]="'请选择管理员'" [nzShowSearch]="true" formControlName="approver">
                            <nz-option *ngFor="let i of users" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzLg]="{ span: 8 }" [nzMd]="{ span: 12 }" [nzXl]="{ span: 6, offset: 2 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>生效日期</nz-form-label>
                    <nz-form-control>
                        <nz-range-picker [style]="{ width: '100%' }" formControlName="date_range"></nz-range-picker>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzLg]="{ span: 10 }" [nzMd]="{ span: 24 }" [nzXl]="{ span: 8, offset: 2 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>仓库类型</nz-form-label>
                    <nz-form-control nzErrorTip="请选择仓库类型">
                        <nz-select [nzPlaceHolder]="'请选择仓库类型'" [nzShowSearch]="true" formControlName="type">
                            <nz-option [nzLabel]="'私密'" [nzValue]="'private'"></nz-option>
                            <nz-option [nzLabel]="'公开'" [nzValue]="'public'"></nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
        </nz-row>
    </nz-card>
    <nz-card [nzBordered]="false" nzTitle="任务管理">
        <nz-row nzGutter="16">
            <nz-col nzLg="6" nzMd="12" nzSm="24">
                <nz-form-item>
                    <nz-form-label>任务名</nz-form-label>
                    <nz-form-control nzErrorTip="请输入任务名">
                        <input formControlName="name2" nz-input placeholder="请输入任务名"/>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzLg]="{ span: 8 }" [nzMd]="{ span: 12 }" [nzXl]="{ span: 6, offset: 2 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>任务描述</nz-form-label>
                    <nz-form-control nzErrorTip="请输入任务描述">
                        <textarea [nzAutosize]="true" formControlName="summary" nz-input
                                  placeholder="请输入任务描述"></textarea>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzLg]="{ span: 10 }" [nzMd]="{ span: 24 }" [nzXl]="{ span: 8, offset: 2 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>执行人</nz-form-label>
                    <nz-form-control nzErrorTip="请选择执行人">
                        <nz-select [nzPlaceHolder]="'请选择执行人'" [nzShowSearch]="true" formControlName="owner2">
                            <nz-option *ngFor="let i of users" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
        </nz-row>
        <nz-row nzGutter="16">
            <nz-col nzLg="6" nzMd="12" nzSm="24">
                <nz-form-item>
                    <nz-form-label>责任人</nz-form-label>
                    <nz-form-control nzErrorTip="请选择责任人">
                        <nz-select [nzPlaceHolder]="'请选择责任人'" [nzShowSearch]="true" formControlName="approver2">
                            <nz-option *ngFor="let i of users" [nzLabel]="i.label" [nzValue]="i.value"></nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzLg]="{ span: 8 }" [nzMd]="{ span: 12 }" [nzXl]="{ span: 6, offset: 2 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>生效时间</nz-form-label>
                    <nz-form-control>
                        <nz-time-picker formControlName="time"></nz-time-picker>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
            <nz-col [nzLg]="{ span: 10 }" [nzMd]="{ span: 24 }" [nzXl]="{ span: 8, offset: 2 }" nzSm="24">
                <nz-form-item>
                    <nz-form-label>任务类型</nz-form-label>
                    <nz-form-control nzErrorTip="请选择任务类型">
                        <nz-select [nzPlaceHolder]="'请选择任务类型'" [nzShowSearch]="true" formControlName="type2">
                            <nz-option [nzLabel]="'私密'" [nzValue]="'private'"></nz-option>
                            <nz-option [nzLabel]="'公开'" [nzValue]="'public'"></nz-option>
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>
            </nz-col>
        </nz-row>
    </nz-card>
    <nz-card [nzBordered]="false" nzTitle="成员管理">
        <nz-table [nzData]="items.value" [nzShowPagination]="false" formArrayName="items">
            <thead>
            <tr>
                <th>成员姓名</th>
                <th>工号</th>
                <th>所属部门</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let item of items.controls; let i = index" [formGroupName]="i">
                <td>
                    <span *ngIf="editIndex !== i">{{ items.value[i].name }}</span>
                    <span *ngIf="editIndex === i" nz-form-control nzErrorTip="请输入成员姓名">
              <input formControlName="name" nz-input placeholder="请输入成员姓名"/>
            </span>
                </td>
                <td>
                    <span *ngIf="editIndex !== i">{{ items.value[i].workId }}</span>
                    <span *ngIf="editIndex === i" nz-form-control nzErrorTip="请输入工号">
              <input formControlName="workId" nz-input placeholder="请输入工号"/>
            </span>
                </td>
                <td>
                    <span *ngIf="editIndex !== i">{{ items.value[i].department }}</span>
                    <span *ngIf="editIndex === i" nz-form-control nzErrorTip="请输入所属部门">
              <input formControlName="department" nz-input placeholder="请输入所属部门"/>
            </span>
                </td>
                <td>
            <span *ngIf="editIndex !== i">
              <a (click)="edit(i)">编辑</a>
              <nz-divider nzType="vertical"></nz-divider>
              <a (nzOnConfirm)="del(i)" nz-popconfirm nzPopconfirmTitle="是否要删除此行？">删除</a>
            </span>
                    <span *ngIf="editIndex === i">
              <a (click)="save(i)">保存</a>
              <nz-divider nzType="vertical"></nz-divider>
              <a (nzOnConfirm)="cancel(i)" nz-popconfirm nzPopconfirmTitle="是否要取消操作？">取消</a>
            </span>
                </td>
            </tr>
            </tbody>
        </nz-table>
        <button (click)="add()" *ngIf="editIndex === -1" [nzType]="'dashed'" class="mt-md" nz-button nzBlock>
            <i nz-icon nzType="plus"></i>
            <span>新增成员</span>
        </button>
    </nz-card>
    <footer-toolbar errorCollect>
        <button nz-button nzType="primary" type="primary">提交</button>
    </footer-toolbar>
</form>
